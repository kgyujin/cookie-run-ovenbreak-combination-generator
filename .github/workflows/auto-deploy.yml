name: ğŸš€ Auto Merge & Deploy Bypass

# 'dev' ë¸Œëœì¹˜ì— ì½”ë“œê°€ ì˜¬ë¼ì˜¤ë©´ ì‘ë™í•©ë‹ˆë‹¤
on:
  push:
    branches:
      - dev

jobs:
  bypass-vercel-limit:
    runs-on: ubuntu-latest
    steps:
      # 1. ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
      - name: Checkout code
        uses: actions/checkout@v3
        with:
          fetch-depth: 0 # ë³‘í•©ì„ ìœ„í•´ ì „ì²´ íˆìŠ¤í† ë¦¬ ê°€ì ¸ì˜¤ê¸°
          token: ${{ secrets.MY_GITHUB_TOKEN }} # ì£¼ì¸ì˜ ê¶Œí•œìœ¼ë¡œ ê°€ì ¸ì˜´

      # 2. ê¹ƒí—ˆë¸Œ ë¡œë´‡ì—ê²Œ ì£¼ì¸ì˜ ì‹ ë¶„ ë¶€ì—¬ (ì¤‘ìš”!)
      - name: Setup Git User as Owner
        run: |
          # ì•„ë˜ ë‘ ì¤„ì„ ë³¸ì¸ì˜ ê¹ƒí—ˆë¸Œ ì´ë©”ì¼ê³¼ ì•„ì´ë””ë¡œ ìˆ˜ì •í•´ì£¼ì„¸ìš”!
          git config --global user.email "k_gyujin@daum.net"
          git config --global user.name "kgyujin"

      # 3. main ë¸Œëœì¹˜ë¡œ ì´ë™í•´ì„œ dev ë‚´ìš©ì„ í•©ì¹˜ê³  í‘¸ì‹œ
      - name: Merge dev to main
        run: |
          git checkout main
          git merge origin/dev --allow-unrelated-histories -m "ğŸ”€ Auto-merge for Vercel Deploy"
          git push origin main